<!DOCTYPE html>
<html>
  <head>
    <script>
      function setDarkMode(isWanted) {
        if (Boolean(isWanted))
          document.documentElement.classList.add('dark')
        else
          document.documentElement.classList.remove('dark')
      }

      function evalDarkMode() {
        const invert = localStorage.invertTheme === "true";
        const prefer = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const useDark = invert ? !prefer : prefer;
        setDarkMode(useDark)
      }

      function toggleDarkMode() {
        localStorage.invertTheme = localStorage.invertTheme === "true" ? "false" : "true"
        evalDarkMode()
      }

      evalDarkMode()
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    {{ $stylesheets := slice "gruvbox" "chroma" "style" }}
    {{ range $stylesheets }}
      {{ $path := fmt.Printf "css/%s.css" . }}
      {{ with resources.Get $path | minify | fingerprint }}
        <link rel="stylesheet" href="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" />
      {{ end }}
    {{ end }}

    <!-- Search Engine Optimization (SEO) related tags -->
    <link rel="canonical" href="{{ .Permalink }}" />
    <meta name="og:url" href="{{ .Permalink }}" />

    {{ $desc := site.Params.Description }}
    {{- if .Params.Description }}
      {{ $desc = .Params.Description }}
    {{- end }}
    <meta name="description" content="{{ $desc }}" />
    <meta name="og:description" content="{{ $desc }}" />

    {{ with resources.Get "img/pp.webp" }}
      {{ with .Resize "32x" | fingerprint "md5" }}
        <link rel="icon" type="image/webp" href="{{ .RelPermalink }}"/>
      {{ end }}
    {{ end }}
    {{ block "image_preview" . }}
      {{ $imgPreview := resources.Get "img/pp.webp" | fingerprint "md5" }}
      <meta property="og:image" content="{{ $imgPreview.RelPermalink }}" />
      <meta property="twitter:image" content="{{ $imgPreview.RelPermalink }}" />
    {{ end }}

    <title>
      {{ block "title" . }}
        {{- if .Params.hide_site_title -}}
          {{ .Page.Title }}
        {{- else if .Page.Title -}}
          {{ .Page.Title }} |
          {{ .Site.Title }}
        {{- else -}}
          {{ .Site.Title }}
        {{- end -}}
      {{ end }}
    </title>

    {{ block "head" . }}
    {{ end }}
  </head>

  <body class="p-4">
    {{ partial "nav/full.html" . }}
    {{ block "main" . }}
    {{ end }}
    {{ block "footer" . }}
    {{ end }}

    {{ $instantpage := resources.Get "js/instantpage.js" | minify }}
    <script src="{{ $instantpage.RelPermalink }}" type="module"></script>
  </body>
</html>
