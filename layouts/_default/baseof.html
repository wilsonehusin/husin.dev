<!doctype html>
<html>
  <head>
    <script>
      {{- with resources.Get "js/dark-mode.js" | minify -}}
        {{- .Content | safeJS -}}
      {{- end -}}
      evalDarkMode();
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    {{- hugo.Generator -}}

    {{- $fonts := slice "inter" "victor" -}}
    {{- range $fonts -}}
      {{- $path := fmt.Printf "css/fonts/%s.css" . -}}
      {{- $r := resources.Get $path -}}
      {{- with resources.ExecuteAsTemplate $path $ $r | minify | fingerprint -}}
        <link
          rel="stylesheet"
          href="{{- .RelPermalink -}}"
          integrity="{{- .Data.Integrity -}}"
        />
      {{- end -}}
    {{- end -}}

    {{- $stylesheets := slice "gruvbox" "chroma" "dist" -}}
    {{- range $stylesheets -}}
      {{- $path := fmt.Printf "css/%s.css" . -}}
      {{- with resources.Get $path | minify | fingerprint -}}
        <link
          rel="stylesheet"
          href="{{- .RelPermalink -}}"
          integrity="{{- .Data.Integrity -}}"
        />
      {{- end -}}
    {{- end -}}

    {{- $javascripts := slice "navigation-menu" -}}
    {{- range $javascripts -}}
      {{- $path := fmt.Printf "js/%s.js" . -}}
      {{- with resources.Get $path | minify | fingerprint -}}
        <script
          src="{{- .RelPermalink -}}"
          integrity="{{- .Data.Integrity -}}"
        ></script>
      {{- end -}}
    {{- end -}}

    {{- $jsVendors := slice
      "https://cdn.jsdelivr.net/npm/@github/relative-time-element@4/dist/bundle.js"
      "https://cdn.jsdelivr.net/npm/instant.page@5/instantpage.min.js"
    -}}
    {{- range $jsVendors -}}
      {{- partial "vendor/js.html" . -}}
    {{- end -}}


    <!-- Search Engine Optimization (SEO) related tags -->
    <link rel="canonical" href="{{- .Permalink -}}" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="{{- site.Title -}}" />
    <meta property="og:url" content="{{- .Permalink -}}" />
    <meta property="twitter:url" content="{{- .Permalink -}}" />
    <meta property="twitter:domain" content="husin.dev" />
    <meta name="twitter:creator" content="@wilsonehusin" />

    {{- $desc := site.Params.Description -}}
    {{- if .Params.Description -}}
      {{- $desc = .Params.Description -}}
    {{- else if and (eq .Page.Kind "page") .Page.Summary -}}
      {{- $desc = .Page.Summary -}}
    {{- end -}}
    <meta property="description" content="{{- site.Params.Description -}}" />
    <meta property="og:description" content="{{- $desc -}}" />
    <meta name="twitter:description" content="{{- $desc -}}" />

    {{- with resources.Get "img/pp.webp" -}}
      {{- with .Resize "32x" | fingerprint -}}
        <link rel="icon" type="image/webp" href="{{- .RelPermalink -}}" />
      {{- end -}}
    {{- end -}}

    {{- $imgAlt := fmt.Printf "Profile picture of %s." site.Title -}}
    {{- $imgPreview := resources.Get "img/pp.webp" -}}
    {{- $imgCard := "summary" -}}
    {{- if .Page.Param "header" -}}
      {{- $imgAlt = .Page.Param "header.alt" -}}
      {{- $imgPreview = .Page.Resources.GetMatch (.Page.Param "header.src") -}}
      {{- $imgPreview = $imgPreview.Process "webp" -}}
      {{- $imgCard = "summary_large_image" -}}
    {{- end -}}

    {{- with $imgPreview | fingerprint -}}
      <meta property="og:image" content="{{- .Permalink -}}" />
      <meta property="og:image:alt" content="{{- $imgAlt -}}" />
      <meta property="twitter:image" content="{{- .Permalink -}}" />
      <meta property="twitter:card" content="{{- $imgCard -}}" />
    {{- end -}}

    {{- $title := site.Title -}}
    {{- if .Params.hide_site_title -}}
      {{- $title = .Page.Title -}}
    {{- else if .Page.Title -}}
      {{- $title = fmt.Printf "%s | %s" .Page.Title site.Title -}}
      {{- if eq .Page.Kind "term" -}}
        {{- $title = fmt.Printf "%s%s" "#" $title -}}
      {{- end -}}
    {{- end -}}
    <title>
      {{- $title -}}
    </title>
    <meta property="og:title" content="{{- $title -}}" />
    <meta name="twitter:title" content="{{- $title -}}" />

    {{- block "head" . -}}{{- end -}}
  </head>

  <body class="text-default bg-bg-hard px-4 pb-8 text-base">
    {{ partial "nav.html" . }}
    {{ block "main" . }}{{ end }}
    {{ block "footer" . }}{{ end }}
    <div
      class="mx-auto my-6 flex max-w-7xl flex-col items-center text-xs font-light text-fg4 sm:my-16"
    >
      <hr class="my-2 w-8 text-yellow-dim" />
      <p>Â© 2023-{{ time.Now.Year }} Wilson Husin</p>
    </div>
  </body>
</html>
